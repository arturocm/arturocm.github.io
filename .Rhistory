text = name,
orientation = "h")
f1 <- list(
family = "Arial, sans-serif",
size = 18,
color = "lightgrey"
)
f2 <- list(
family = "Old Standard TT, serif",
size = 12,
color = "black"
)
x <- list(
title = "USD Million",
titlefont = f1,
showticklabels = TRUE,
tickfont = f2,
exponentformat = "e",
showexponent = "All"
)
y <- list(
title = "TEAM",
titlefont = f1,
showticklabels = TRUE,
tickfont = f2,
exponentformat = "e",
showexponent = "All"
)
m = list(l = 150, r = 20, b = 50, t = 50, pad = 4)
layout(p,
title=Plot.Title,
hovermode = "closest",
barmode = "stack",
xaxis = x,
yaxis = y,
margin = m)
}
color.column <- function(x = data){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
return(draft)
}
team.value <- transfermarkt(url.all)
draft <- cleansing(team.value)
final.draft <- color.column(draft)
league.plot(final.draft, "Liga MX")
head(team.value)
head(draft)
head(final.draft)
sorting <- agretage(value.adj ~ team, data=final.draft, FUN = sum)
sorting <- agregate(value.adj ~ team, data=final.draft, FUN = sum)
sorting <- aggregate(value.adj ~ team, data=final.draft, FUN = sum)
sorting
sorting <- aggregate(value.adj ~ team, data=final.draft, FUN = sum) %>%
sort()
sorting <- sorting[order(value.adj)]
sorting <- sorting[order(sorting$value.adj)]
sorting <- sorting[order(sorting$value.adj),]
head(sorting)
sorting <- sorting[order(-sorting$value.adj),]
head(sorting)
color.column <- function(x = data){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
b <- b[order(-b$value.adj),]
inner_join(draft, b, by = "team")
return(draft)
}
final.draft <- color.column(draft)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
b <- b[order(-b$value.adj),]
draft <- inner_join(draft, b, by = "team")
return(draft)
}
final.draft <- color.column(draft)
head(final.draft)
color.column <- function(x = data){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total),]
return(draft)
}
final.draft <- color.column(draft)
league.plot(final.draft, "Liga MX")
head(final.draft)
tail(final.draft)
unique(final.draft$total)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
if (team_rank = 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total),]
return(draft)
}
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total),]
return(draft)
}
team.value <- transfermarkt(url.all)
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total),]
return(draft)
}
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
head(final.draft)
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total, -draft$value.adj),]
return(draft)
}
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(draft$total, draft$value.adj),]
return(draft)
}
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total, draft$value.adj),]
return(draft)
}
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
head(final.draft)
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$total, -draft$value.adj),]
return(draft)
}
team.value <- transfermarkt(url.all)
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(-draft$value.adj),]
return(draft)
}
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
color.column <- function(x = data, team_rank = 0){
draft <- arrange(x, value.adj)
set.color <- cbind.data.frame(value.adj = unique(draft$value.adj),
color.set =colorRampPalette(
brewer.pal(9,"Spectral"))(
length(unique(draft$value.adj))))
draft <- full_join(draft, as.data.table(set.color), by = "value.adj")
b <- aggregate(value.adj ~ team, data=draft, FUN = sum)
names(b) <- c("team","total")
b <- b[order(-b$total),]
if (team_rank == 0){
b <- b}
else{
b <- b[1:team_rank,]
}
draft <- inner_join(draft, b, by = "team")
draft <- draft[order(draft$value.adj),]
return(draft)
}
final.draft <- color.column(draft, team_rank = 20)
league.plot(final.draft, "Liga MX")
library(brocks)
blog_gen()
blog_gen()
blog_gen()
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 0)
head(final.draft)
tail(final.draft)
draft <- cleansing(team.value)
final.draft <- color.column(draft)
library(DT)
draft <- cleansing(team.value)
final.draft <- color.column(draft)
datatable(final.draft, options = list(pageLength = 10))
install.packages("DT")
library(DT)
draft <- cleansing(team.value)
final.draft <- color.column(draft)
datatable(final.draft, options = list(pageLength = 10))
names(final.draft)
final.table <- select(final.draft, number, name, position, age, team, value, USD = value.adj)
datatable(final.table, options = list(pageLength = 10))
final.table <- select(final.draft, number, name, position, age, team, value, USD = value.adj) %>% arrange(desc(USD))
datatable(final.table, options = list(pageLength = 10))
blog_gen()
library(DT)
draft <- cleansing(team.value)
final.draft <- color.column(draft)
final.table <- select(final.draft,
number,
name,
position,
age,
team,
value,
USD = value.adj) %>%
arrange(desc(USD))
x <- datatable(final.table, options = list(pageLength = 10))
x
blog_gen()
library(brocks)
blog_gen()
blog_serve()
blog_gen()
library(brocks)
install.packages("DT")
install.packages("DT")
install.packages("DT")
install.packages("DT")
library(brocks)
library("DT", lib.loc="/Library/Frameworks/R.framework/Versions/3.2/Resources/library")
blog_gen()
x
print(x)
class(x)
x$dependencies
devtools::install_github('rstudio/DT')
blog_gen()
x
head(final.draft)
final.draft2 <- ddply(final.draft, .(team), transform, Clubcost = sum(value.adj))
library(dplyr)
final.draft2 <- ddply(final.draft, .(team), transform, Clubcost = sum(value.adj))
library(plyr)
final.draft2 <- ddply(final.draft, .(team), transform, Clubcost = sum(value.adj))
head(final.draft2)
head(fina.draft)
head(final.draft)
final.draft <- color.column(draft, team_rank = 20)
final.draft <- arrange(final.draft, desc(total), desc(value.adj))
league.plot(final.draft, "Most Expensive Soccer teams from America")
final.draft <- color.column(draft, team_rank = 20)
final.draft <- arrange(final.draft, desc(total), desc(value.adj))
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
library(rvest)
library(XML)
library(data.table)
library(plotly)
library(RColorBrewer)
library(dplyr)
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
final.draft <- arrange(final.draft, desc(total), desc(value.adj))
league.plot(final.draft, "Most Expensive Soccer teams from America")
draft <- cleansing(team.value)
final.draft <- color.column(draft, team_rank = 20)
final.draft <- arrange(final.draft, desc(total), value.adj)
league.plot(final.draft, "Most Expensive Soccer teams from America")
final.draft <- arrange(final.draft, desc(total))
league.plot(final.draft, "Most Expensive Soccer teams from America")
head(final.draft)
tail(final.draft)
?barplot
final.draft <- arrange(final.draft, desc(total), desc(value.adj))
league.plot(final.draft, "Most Expensive Soccer teams from America")
league.plot <- function(x = data, Plot.Title = "League"){
p <- plot_ly(data = x,
y = team,
x = value.adj,
marker = list(color = color.set,
line= list(color='white',  # set bar border color
width=.5 )),     # set bar border width
opacity = .9,
group = total,
type = "bar",
showlegend = FALSE,
bargap = 0.5,
text = name,
orientation = "h")
f1 <- list(
family = "Arial, sans-serif",
size = 18,
color = "lightgrey"
)
f2 <- list(
family = "Old Standard TT, serif",
size = 12,
color = "black"
)
x <- list(
title = "USD Million",
titlefont = f1,
showticklabels = TRUE,
tickfont = f2,
exponentformat = "e",
showexponent = "All"
)
y <- list(
title = "TEAM",
titlefont = f1,
showticklabels = TRUE,
tickfont = f2,
exponentformat = "e",
showexponent = "All"
)
m = list(l = 150, r = 20, b = 50, t = 50, pad = 4)
layout(p,
title=Plot.Title,
hovermode = "closest",
barmode = "stack",
xaxis = x,
yaxis = y,
margin = m)
}
final.draft <- arrange(final.draft, desc(total), desc(value.adj))
league.plot(final.draft, "Most Expensive Soccer teams from America")
final.draft <- arrange(final.draft, desc(total), (value.adj))
league.plot(final.draft, "Most Expensive Soccer teams from America")
final.draft <- arrange(final.draft, (total), (value.adj))
league.plot(final.draft, "Most Expensive Soccer teams from America")
library(DT)
draft <- cleansing(team.value)
final.draft <- color.column(draft)
final.table <- select(final.draft,
number,
name,
position,
age,
team,
value,
USD = value.adj)
final.table <- arrange(final.table, desc(USD))
x <- datatable(final.table, options = list(pageLength = 10))
x
# Set the initial url to pull the data
url.t <- "http://www.transfermarkt.es"
# obtained the links for all the soccer leagues from america available
url.mx <- "/liga-mx-clausura/marktwerteverein/wettbewerb/MEX1/" #mexico
url.us <- "/major-league-soccer/marktwerteverein/wettbewerb/MLS1" #US
url.br <- "/campeonato-brasileiro-serie-a/marktwerteverein/wettbewerb/BRA1" #Brazil
url.co <- "/liga-postobon-i/marktwerteverein/wettbewerb/COLP" #Colombia
url.ec <- "/serie-a-primera-etapa/marktwerteverein/wettbewerb/ECPE" #Ecuador
url.ur <- "/primera-division-apertura/marktwerteverein/wettbewerb/URU1" #Uruguay
url.ch <- "/primera-division-apertura/marktwerteverein/wettbewerb/CHLA" #Chile
url.cr <- "/primera-division-invierno/marktwerteverein/wettbewerb/CRPD" #C Rica
url.pe <- "/torneo-descentralizado-clausura-entscheidungsspiel/
marktwerteverein/wettbewerb/PERD" #Peru
url.ar <- "/primera-division/marktwerteverein/wettbewerb/AR1N" #Argentina
# Add all the american leagues
url.all<- c(url.mx, url.us, url.br, url.ar, url.co, url.ec, url.ur, url.ch, url.cr, url.pe)
# Here is the link in case you want to add "La Liga" from spain
url.es <- "/primera-division/marktwerteverein/wettbewerb/ES1"
url.pe
# Set the initial url to pull the data
url.t <- "http://www.transfermarkt.es"
# obtained the links for all the soccer leagues from america available
url.mx <- "/liga-mx-clausura/marktwerteverein/wettbewerb/MEX1/" #mexico
url.us <- "/major-league-soccer/marktwerteverein/wettbewerb/MLS1" #US
url.br <- "/campeonato-brasileiro-serie-a/marktwerteverein/wettbewerb/BRA1" #Brazil
url.co <- "/liga-postobon-i/marktwerteverein/wettbewerb/COLP" #Colombia
url.ec <- "/serie-a-primera-etapa/marktwerteverein/wettbewerb/ECPE" #Ecuador
url.ur <- "/primera-division-apertura/marktwerteverein/wettbewerb/URU1" #Uruguay
url.ch <- "/primera-division-apertura/marktwerteverein/wettbewerb/CHLA" #Chile
url.cr <- "/primera-division-invierno/marktwerteverein/wettbewerb/CRPD" #C Rica
url.pe <- "/torneo-descentralizado-clausura-entscheidungsspiel/
marktwerteverein/wettbewerb/PERD" #Peru
url.ar <- "/primera-division/marktwerteverein/wettbewerb/AR1N" #Argentina
# Add all the american leagues
url.all<- c(url.mx, url.us, url.br, url.ar, url.co, url.ec, url.ur, url.ch, url.cr, url.pe)
# Here is the link in case you want to add "La Liga" from spain
url.es <- "/primera-division/marktwerteverein/wettbewerb/ES1"
url.pe
new_post("Hello World")
new_post("Hello World")
